function PicturePerfect(e,t){var i=this;t=t||{},i.options=t,i.img=e,i.initialized=!(0!=t.lazy&&i.lazyLoad),i.maxWindowSize=window.innerWidth,i.picturefill=function(){},"undefined"!=typeof picturefill&&(i.picturefill=picturefill),i._calculateSizes=function(){0!=t.calculateSize&&i.setElementSize&&i.setElementSize(e)},i._updateSources=function(){0!=t.dynamicSources&&i.updateSources&&i.updateSources(i.img)},i._mimicBackgroundImage=function(){0!=t.mimicBackgroundImage&&i.mimicBackgroundImage&&i.mimicBackgroundImage(i.img)},i.addClass=function(e){-1==i.img.className.indexOf(e)&&setTimeout(function(){i.img.className=i.img.className+=" "+e},10)},i.removeClass=function(e){var t=new RegExp(e,"gi");i.img.className=i.img.className.replace(t,"")},i.onProximity=function(){i.initialized&&(i.addClass("picture-perfect-ready"),i.img.addEventListener("load",i.onLoad),window.addEventListener("resize",function(){setTimeout(i.onResize,100)}),i._calculateSizes(),i._updateSources(),i.picturefill({reevaluate:!0}),i._mimicBackgroundImage())},i.onResize=function(){i.maxWindowSize<window.innerWidth&&(i.maxWindowSize=window.innerWidth,i._updateSources()),i._calculateSizes(),i.picturefill({reevaluate:!0}),i._mimicBackgroundImage()},i.onLoad=function(e){i.addClass("picture-perfect-loaded"),i._mimicBackgroundImage()},i.onLoadStart=function(e){i.removeClass("picture-perfect-loaded")},i.img.addEventListener("loadstart",i.onLoadStart),i.addClass("picture-perfect"),i.initialized?i.onProximity():i.lazyLoad(),i._mimicBackgroundImage(),window.addEventListener("load",function(){i.onProximity()})}var JIT_IMG=function(e,t){new PicturePerfect(e,t),e.onload=null};PicturePerfect.prototype.lazyLoadAttributes=function(e,t){t.forEach(function(t){var i=e.getAttribute("lazy-"+t);"background-image"==t&&i?e.style.backgroundImage='url("'+i+'")':i&&e.setAttribute(t,i)})},PicturePerfect.prototype.lazyLoad=function(){var onScroll,rect,self=this,proximityThreshold=window.innerHeight/2,img=self.img;try{proximityThreshold=eval(img.getAttribute("lazy-threshold"))||proximityThreshold}catch(e){console.log(e)}onScroll=function(){if((rect=img.getBoundingClientRect()).bottom>0&&rect.top-window.innerHeight<proximityThreshold||rect.top<0&&rect.bottom-window.innerHeight>-1*proximityThreshold){window.removeEventListener("scroll",onScroll);var e=img.parentElement;if(e&&/picture/gi.test(e.tagName))for(let i=0;i<e.childNodes.length;i++){var t=e.childNodes[i];/source/gi.test(t.tagName)&&self.lazyLoadAttributes(t,["src","srcset","background-image"])}self.initialized=!0,self.lazyLoadAttributes(img,["src","srcset","background-image"]),self.onProximity()}},window.addEventListener("scroll",onScroll),onScroll()},PicturePerfect.prototype.handPickSizeFor=function(e){return Math.ceil(e.getBoundingClientRect().width/window.innerWidth*100)+"vw"},PicturePerfect.prototype.setElementSize=function(e){e.setAttribute("sizes",this.handPickSizeFor(e))},PicturePerfect.prototype.getCurrentSrcSize=function(e,t){var i=new Image;i.onload=function(){t({width:i.width,height:i.height})},i.src=e.currentSrc},PicturePerfect.prototype.mimicBackgroundImage=function(e){var t=e.closest("[mimic-background-image-wrapper]"),i=e.closest("[mimic-background-image-container]");if(!i||!t)return!1;this.getCurrentSrcSize(e,function(o){var n=t.currentStyle||window.getComputedStyle(t),r="cover"==n.backgroundSize,a="contain"==n.backgroundSize,c=i.getBoundingClientRect(),l=o.width/o.height*c.height,d=(o.height,o.width,c.width,c.width),s=c.height,u=l>=c.width;r?(u?d=l:s=o.height/o.width*c.width,e.style.width=u?"auto":"100%",e.style.height=u?"100%":"auto"):a&&(u?s=o.height/o.width*c.width:d=l,e.style.width=u?"100%":"auto",e.style.height=u?"auto":"100%");var m=n.backgroundPosition.split(" "),g=m[0],h=m[1];if(g.indexOf("px")>-1)e.style.left=g;else if(g.indexOf("%")>-1){var f=parseFloat(g.replace("%",""));e.style.left=(c.width-d)*(f/100)+"px"}else e.style.left=(c.width-d)/2+"px";if(h.indexOf("px")>-1)e.style.top=h;else if(h.indexOf("%")>-1){f=parseFloat(h.replace("%",""));e.style.top=(c.height-s)*(f/100)+"px"}else e.style.top=(c.height-s)/2+"px"})};